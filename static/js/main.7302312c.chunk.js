(this["webpackJsonpmusical-akinator"]=this["webpackJsonpmusical-akinator"]||[]).push([[0],[,,,,,,,,,function(e,t,n){e.exports=n(19)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(1),o=n.n(i),s=(n(14),n(2)),l=n(3),c=n(6),u=n(5),d=n(7),h=(n(15),{}),p={},f=function(e){p[e.id]=r.a.createRef();var t=e.route&&window.location.pathname===e.route,n=r.a.createElement("div",{id:e.id,className:"page"+(t?" active":""),ref:p[e.id]},e.children);return t&&(document.body.className=e.id),e.route&&(h[e.route]=e.id),n};function v(e){return e.indexOf("?")>=0&&(e=e.substring(0,e.indexOf("?"))),e.indexOf("#")>=0&&(e=e.substring(0,e.indexOf("#"))),e}var m=function(e){for(var t in document.body.className=e,p){p[t].current.className="page "+(t===e?"active":"")}};window.R=function(e){window.history.pushState("","",e),m(h[v(e)]||"404")},window.addEventListener("load",(function(){var e=v(window.location.pathname);"undefined"===typeof h[e]&&m("404")}));var y=n(4);function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function g(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var w=r.a.createElement("path",{d:"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"}),O=r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),k=function(e){var t=e.svgRef,n=e.title,a=g(e,["svgRef","title"]);return r.a.createElement("svg",b({width:24,height:24,viewBox:"0 0 24 24",ref:t},a),n?r.a.createElement("title",null,n):null,w,O)},x=r.a.forwardRef((function(e,t){return r.a.createElement(k,b({svgRef:t},e))}));n.p;function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function R(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var C=r.a.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),M=r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),j=function(e){var t=e.svgRef,n=e.title,a=R(e,["svgRef","title"]);return r.a.createElement("svg",E({width:24,height:24,viewBox:"0 0 24 24",ref:t},a),n?r.a.createElement("title",null,n):null,C,M)},S=r.a.forwardRef((function(e,t){return r.a.createElement(j,E({svgRef:t},e))}));n.p;function z(){return(z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function N(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var P=r.a.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),L=r.a.createElement("path",{d:"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"}),T=function(e){var t=e.svgRef,n=e.title,a=N(e,["svgRef","title"]);return r.a.createElement("svg",z({width:24,height:24,viewBox:"0 0 24 24",ref:t},a),n?r.a.createElement("title",null,n):null,P,L)},D=r.a.forwardRef((function(e,t){return r.a.createElement(T,z({svgRef:t},e))})),I=(n.p,n(16),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).enterHandler=n.onEnter.bind(Object(y.a)(n)),n.state={disabled:e.disabled},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"_down",value:function(e,t){if(!this.state.disabled){var n=e.getBoundingClientRect(),a=t.clientX-n.left,r=t.clientY-n.top,i=Math.max(Math.sqrt(Math.pow(a,2)+Math.pow(r,2)),Math.sqrt(Math.pow(a-n.width,2)+Math.pow(r,2)),Math.sqrt(Math.pow(a,2)+Math.pow(r-n.height,2)),Math.sqrt(Math.pow(a-n.width,2)+Math.pow(r-n.height,2))),o=document.createElement("div");o.className="ripple",o.style.position="absolute",o.style.transition="all 0.25s cubic-bezier(0.215, 0.61, 0.355, 1)",o.style.borderRadius="50%",o.style.opacity="1",o.style.top=r+"px",o.style.left=a+"px",o.style.width=o.style.height="0px",o.id="s"+Date.now(),setTimeout((function(){o.style.opacity="0.75",o.style.top=r-i+"px",o.style.left=a-i+"px",o.style.width=o.style.height=2*i+"px"}),10),e.append(o)}}},{key:"_up",value:function(e,t){var n=e.querySelectorAll(".ripple");if(null!=n)for(var a=function(e){var t=n[e],a=parseInt(t.id.substring(1));Date.now()-a>250?(t.style.opacity="0",setTimeout(t.remove.bind(t),250)):setTimeout((function(){t.style.opacity="0",setTimeout(t.remove.bind(t),250)}),250-(Date.now()-a))},r=0;r<n.length;++r)a(r)}},{key:"componentDidMount",value:function(){var e=o.a.findDOMNode(this);e.style.position="relative",e.style.overflow="hidden",this.down=this._down.bind(this,e),this.up=this._up.bind(this,e),e.addEventListener("mousedown",this.down),document.body.addEventListener("mouseup",this.up)}},{key:"componentWillMount",value:function(){this.props.enter&&window.addEventListener("keyup",this.enterHandler)}},{key:"componentWillUnmount",value:function(){this.props.enter&&window.removeEventListener("keyup",this.enterHandler),document.body.removeEventListener("mouseup",this.up)}},{key:"componentWillReceiveProps",value:function(e){e.disabled!==this.state.disabled&&this.setState({disabled:e.disabled})}},{key:"onEnter",value:function(e){13!==e.keyCode||e.ctrlKey||e.metaKey||"function"!==typeof this.props.onClick||this.props.disabled||this.props.onClick()}},{key:"redirect",value:function(e){this.props.disabled||(window.location.href=e)}},{key:"render",value:function(){var e=this.props.className||"";return this.props.invert&&(e+=" invert"),this.state.disabled&&(e+=" disabled"),r.a.createElement("div",{className:e+" button",id:this.props.id,onClick:function(){this.props.disabled||(this.props.to?this.redirect.bind(this,this.props.to):this.props.onClick)()}.bind(this),style:this.props.style},this.props.children)}}]),t}(r.a.Component)),q=(n(17),function(){function e(){Object(s.a)(this,e),this.tail=null}return Object(l.a)(e,[{key:"push",value:function(e){var t=this.tail;this.tail=Object.assign(e,{next:t})}}]),e}());function H(e){return Object.keys(e).filter((function(t){return e[t]})).join(" ")}var B=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).canvasRendering=!1,n.context=null,n.stream=null,n.source=null,n.processor=null,n.analyser=null,n.recorder=null,n.chunks=[],n.recordingStart=null,n.volumes=null,n.volumeMax=0,n.statusRef=r.a.createRef(),n.canvasRef=r.a.createRef(),n.inputRef=r.a.createRef(),n.state={type:"text",status:"",statusClass:""},n.onResize=n.resizeCanvas.bind(Object(y.a)(n)),n.callback=e.onSelect,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.resizeCanvas(),window.addEventListener("resize",this.onResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize)}},{key:"resizeCanvas",value:function(){var e=o.a.findDOMNode(this),t=e.querySelector("canvas");t.width=e.clientWidth*window.devicePixelRatio,t.height=e.clientHeight*window.devicePixelRatio}},{key:"onMicClick",value:function(){var e=this;this.setState({type:"mic"}),navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(t){e.stream=t,e.context=new AudioContext,e.analyser=e.context.createAnalyser(),e.source=e.context.createMediaStreamSource(e.stream),e.processor=e.context.createScriptProcessor(1024,1,1),e.recorder=new MediaRecorder(e.stream),e.recorder.ondataavailable=function(e){this.chunks.push(e.data)}.bind(e),e.recordingStart=Date.now(),e.volumes=new q,e.volumeMax=0,e.chunks=[],e.recorder.start(),e.startCanvasRendering(),e.source.connect(e.analyser),e.analyser.connect(e.processor),e.processor.connect(e.context.destination),e.processor.onaudioprocess=function(t){if(null!==e.stream&&"mic"===e.state.type&&null!==e.volumes)if(Date.now()-e.recordingStart>6e4)e.stopStream(!0);else{e.analyser.fftSize=2048;var n=e.analyser.frequencyBinCount,a=new Uint8Array(n);e.analyser.getByteFrequencyData(a);for(var r=0,i=0;i<n;++i)r+=a[i];var o=r/n;o>e.volumeMax&&(e.volumeMax=o),e.volumes.push({timestamp:Date.now(),volume:o}),e.statusRef.current.innerHTML=e.durationString(Date.now()-e.recordingStart)}}})).catch((function(){e.setState({statusClass:"error",status:"Failed to access microphone"})}))}},{key:"startCanvasRendering",value:function(){var e=this;this.canvasRendering=!0;var t=this.canvasRef.current,n=t.getContext("2d");!function a(){if(e.canvasRendering){requestAnimationFrame(a.bind(e));var r=t.width,i=t.height;n.clearRect(0,0,r,i);var o=function(e,t,n){return{x:(e.timestamp-this.recordingStart)/6e4*t,y:(1-e.volume/this.volumeMax)*n}}.bind(e);n.beginPath();for(var s=e.volumes.tail,l=null,c=null;null!=s;){var u=o(s,r,i);null==l&&(l=u),n.lineTo(u.x,u.y),c=u,s=s.next}null!=l&&null!=c&&(n.lineTo(0,c.y),n.lineTo(0,i+10),n.lineTo(l.x,i+10)),n.closePath(),n.lineWidth=1.5*window.devicePixelRatio,n.lineCap="round",n.strokeStyle="#1976d2",n.fillStyle="#90caf9",n.stroke(),n.fill()}}()}},{key:"stopCanvasRendering",value:function(){this.canvasRendering=!1}},{key:"stopStream",value:function(e){var t=this;null!==this.stream&&(e&&(this.recorder.onstop=function(){var e=new Blob(t.chunks,{type:t.recorder.mimeType});t.callback({type:"audio",value:e})}),this.recorder.stop(),this.stopCanvasRendering(),this.stream.getTracks().forEach((function(e){e.stop()})),this.stream=null)}},{key:"durationString",value:function(e){var t=Math.floor(e/1e3),n=Math.floor(t/60);return t%=60,this.addZeros(n)+":"+this.addZeros(t)}},{key:"addZeros",value:function(e,t){return"undefined"===typeof t&&(t=2),"string"!==typeof e&&(e+=""),e.length>=t?e:"0".repeat(t-e.length)+e}},{key:"onCloseClick",value:function(){this.setState({type:"text"}),this.stopStream(!1),this.volumes=null,this.volumeMax=0}},{key:"onInputChange",value:function(){this.updClassName()}},{key:"onSendClick",value:function(){if("text"===this.state.type){var e=this.inputRef.current.value.trim();e.length>0&&this.callback({type:"text",value:e})}else null!==this.stream&&this.stopStream(!0)}},{key:"updClassName",value:function(){var e=o.a.findDOMNode(this),t=this.inputRef.current.value.trim();e.className=H({TextOrRecordInput:!0,cansend:t.length>0,mic:"mic"===this.state.type,text:"text"===this.state.type})}},{key:"render",value:function(){var e,t=this.inputRef.current;return e=null!=t?t.value:"",r.a.createElement("div",{className:H({TextOrRecordInput:!0,cansend:e.length>0,mic:"mic"===this.state.type,text:"text"===this.state.type})},r.a.createElement("div",{className:"input-wrapper"},r.a.createElement("input",{type:"text",placeholder:"Write lyrics here or press mic...",ref:this.inputRef,onChange:this.onInputChange.bind(this),onKeyPress:this.onInputChange.bind(this),onKeyUp:this.onInputChange.bind(this)})),r.a.createElement("div",{className:"status "+this.state.statusClass,ref:this.statusRef},this.state.status),r.a.createElement("canvas",{ref:this.canvasRef}),r.a.createElement(I,{className:"mic borderless round",onClick:this.onMicClick.bind(this)},r.a.createElement(x,null)),r.a.createElement(I,{className:"close borderless round",onClick:this.onCloseClick.bind(this)},r.a.createElement(S,null)),r.a.createElement(I,{className:"send borderless round",onClick:this.onSendClick.bind(this)},r.a.createElement(D,null)))}}]),t}(r.a.Component),W={text:"https://api.audd.io/findLyrics/",audio:"https://api.audd.io/recognizeWithOffset/"},A=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).preRef=r.a.createRef(),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"send",value:function(e){var t,n=this,a=W[e.type]+"?api_token=47ad9870695533cb638d9fc29c179a21";"audio"===e.type?(t=new FormData).append("file",e.value):"text"===e.type&&(a+="&q="+encodeURIComponent(e.value));var r=new XMLHttpRequest;r.open("POST",a,!0),r.onreadystatechange=function(){4===r.readyState&&(n.preRef.current.innerHTML=r.responseText)},r.send(t)}},{key:"render",value:function(){return r.a.createElement(f,{id:"index",route:"/"},r.a.createElement("p",null,"Akinator tries to recognize and guess what song you are trying to find. You are welcome to type lyrics or hum song's rythm in microphone."),r.a.createElement(B,{onSelect:this.send.bind(this)}),r.a.createElement("br",null),r.a.createElement("pre",{ref:this.preRef}))}}]),t}(r.a.Component),U=function(){return r.a.createElement(f,{id:"404"},r.a.createElement("p",null,"404!"))};n(18);o.a.render(r.a.createElement((function(){return r.a.createElement("div",{id:"content"},r.a.createElement("div",{id:"header"},r.a.createElement("h1",null,"Musical Akinator")),r.a.createElement("section",{id:"pages-wrapper"},r.a.createElement(A,null),r.a.createElement(U,null)))}),null),document.getElementById("root"))}],[[9,1,2]]]);
//# sourceMappingURL=main.7302312c.chunk.js.map