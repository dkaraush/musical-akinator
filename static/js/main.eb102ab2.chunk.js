(this["webpackJsonpmusical-akinator"]=this["webpackJsonpmusical-akinator"]||[]).push([[0],{28:function(e,t,n){e.exports=n(51)},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(14),s=n.n(i),l=(n(33),n(2)),o=n(3),c=n(9),u=n(8),d=n(10),h=n(17),p=n(15),m=n(54),f=n(53),v=n(5),g=(n(34),function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).enterHandler=n.onEnter.bind(Object(v.a)(n)),n.state={disabled:e.disabled},n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"_down",value:function(e,t){if(!this.state.disabled){var n=e.getBoundingClientRect(),a=t.clientX-n.left,r=t.clientY-n.top,i=Math.max(Math.sqrt(Math.pow(a,2)+Math.pow(r,2)),Math.sqrt(Math.pow(a-n.width,2)+Math.pow(r,2)),Math.sqrt(Math.pow(a,2)+Math.pow(r-n.height,2)),Math.sqrt(Math.pow(a-n.width,2)+Math.pow(r-n.height,2))),s=document.createElement("div");s.className="ripple",s.style.position="absolute",s.style.transition="all 0.25s cubic-bezier(0.215, 0.61, 0.355, 1)",s.style.borderRadius="50%",s.style.opacity="1",s.style.top=r+"px",s.style.left=a+"px",s.style.width=s.style.height="0px",s.id="s"+Date.now(),setTimeout((function(){s.style.opacity="0.75",s.style.top=r-i+"px",s.style.left=a-i+"px",s.style.width=s.style.height=2*i+"px"}),10),e.append(s)}}},{key:"_up",value:function(e,t){var n=e.querySelectorAll(".ripple");if(null!=n)for(var a=function(e){var t=n[e],a=parseInt(t.id.substring(1));Date.now()-a>250?(t.style.opacity="0",setTimeout(t.remove.bind(t),250)):setTimeout((function(){t.style.opacity="0",setTimeout(t.remove.bind(t),250)}),250-(Date.now()-a))},r=0;r<n.length;++r)a(r)}},{key:"componentDidMount",value:function(){var e=s.a.findDOMNode(this);e.style.position="relative",e.style.overflow="hidden",this.down=this._down.bind(this,e),this.up=this._up.bind(this,e),e.addEventListener("mousedown",this.down),document.body.addEventListener("mouseup",this.up)}},{key:"componentWillMount",value:function(){this.props.enter&&window.addEventListener("keyup",this.enterHandler)}},{key:"componentWillUnmount",value:function(){this.props.enter&&window.removeEventListener("keyup",this.enterHandler),document.body.removeEventListener("mouseup",this.up)}},{key:"componentWillReceiveProps",value:function(e){e.disabled!==this.state.disabled&&this.setState({disabled:e.disabled})}},{key:"onEnter",value:function(e){13!==e.keyCode||e.ctrlKey||e.metaKey||"function"!==typeof this.props.onClick||this.props.disabled||this.props.onClick()}},{key:"redirect",value:function(e){this.props.disabled||(window.location.href=e)}},{key:"render",value:function(){var e=this.props.className||"";return this.props.invert&&(e+=" invert"),this.state.disabled&&(e+=" disabled"),r.a.createElement("div",{className:e+" button",id:this.props.id,onClick:function(){this.props.disabled||(this.props.to?this.redirect.bind(this,this.props.to):this.props.onClick)()}.bind(this),style:this.props.style},this.props.children)}}]),t}(r.a.Component));function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function b(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var w=r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),E=r.a.createElement("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}),k=function(e){var t=e.svgRef,n=e.title,a=b(e,["svgRef","title"]);return r.a.createElement("svg",y({width:24,height:24,viewBox:"0 0 24 24",ref:t},a),n?r.a.createElement("title",null,n):null,w,E)},O=r.a.forwardRef((function(e,t){return r.a.createElement(k,y({svgRef:t},e))}));n.p;function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function j(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var R=r.a.createElement("path",{d:"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"}),x=r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),C=function(e){var t=e.svgRef,n=e.title,a=j(e,["svgRef","title"]);return r.a.createElement("svg",S({width:24,height:24,viewBox:"0 0 24 24",ref:t},a),n?r.a.createElement("title",null,n):null,R,x)},M=r.a.forwardRef((function(e,t){return r.a.createElement(C,S({svgRef:t},e))}));n.p;function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function z(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var P=r.a.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),D=r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),T=function(e){var t=e.svgRef,n=e.title,a=z(e,["svgRef","title"]);return r.a.createElement("svg",N({width:24,height:24,viewBox:"0 0 24 24",ref:t},a),n?r.a.createElement("title",null,n):null,P,D)},_=r.a.forwardRef((function(e,t){return r.a.createElement(T,N({svgRef:t},e))}));n.p;function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function L(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var q=r.a.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),A=r.a.createElement("path",{d:"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"}),U=function(e){var t=e.svgRef,n=e.title,a=L(e,["svgRef","title"]);return r.a.createElement("svg",I({width:24,height:24,viewBox:"0 0 24 24",ref:t},a),n?r.a.createElement("title",null,n):null,q,A)},H=r.a.forwardRef((function(e,t){return r.a.createElement(U,I({svgRef:t},e))}));n.p;function W(){return(W=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function B(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var J=r.a.createElement("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}),K=function(e){var t=e.svgRef,n=e.title,a=B(e,["svgRef","title"]);return r.a.createElement("svg",W({width:24,height:24,viewBox:"0 0 24 24",ref:t},a),n?r.a.createElement("title",null,n):null,J)},G=r.a.forwardRef((function(e,t){return r.a.createElement(K,W({svgRef:t},e))})),Y=(n.p,n(35),function(){function e(){Object(l.a)(this,e),this.tail=null}return Object(o.a)(e,[{key:"push",value:function(e){var t=this.tail;this.tail=Object.assign(e,{next:t})}}]),e}());function F(e){return Object.keys(e).filter((function(t){return e[t]})).join(" ")}var X=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).canvasRendering=!1,n.audioSupported="undefined"!==typeof MediaRecorder&&(!!navigator.getUserMedia||navigator.mediaDevices&&!!navigator.mediaDevices.getUserMedia),n.context=null,n.stream=null,n.source=null,n.processor=null,n.analyser=null,n.recorder=null,n.chunks=[],n.recordingStart=null,n.volumes=null,n.volumeMax=0,n.inputDivRef=r.a.createRef(),n.statusRef=r.a.createRef(),n.canvasRef=r.a.createRef(),n.inputRef=r.a.createRef(),n.state={type:"text",status:"",statusClass:""},n.onResize=n.resizeCanvas.bind(Object(v.a)(n)),n.onKeyPress=n.catchEnter.bind(Object(v.a)(n)),n.callback=e.onSelect,n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.resizeCanvas(),window.addEventListener("resize",this.onResize),window.addEventListener("keypress",this.onKeyPress)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize),window.removeEventListener("keypress",this.onKeyPress)}},{key:"resizeCanvas",value:function(){var e=this.inputDivRef.current,t=this.canvasRef.current;null!=t&&null!=e&&(t.width=e.clientWidth*window.devicePixelRatio,t.height=e.clientHeight*window.devicePixelRatio,this.renderCanvas(!1))}},{key:"renderCanvas",value:function(e){var t=this.canvasRef.current;if(null!=t){var n=t.getContext("2d");if(e){if(!this.canvasRendering)return;requestAnimationFrame(this.renderCanvas.bind(this,e))}var a=t.width,r=t.height;if(n.clearRect(0,0,a,r),null!==this.recordingStart){var i=function(e,t,n){return{x:(e.timestamp-this.recordingStart)/25e3*t,y:(1-e.volume/this.volumeMax)*n}}.bind(this);if(n.beginPath(),null==this.volumes)n.moveTo(0,r+10),n.lineTo(0,r/2),n.lineTo((Date.now()-this.recordingStart)/25e3*a,r/2),n.lineTo((Date.now()-this.recordingStart)/25e3*a,r+10);else{for(var s=this.volumes.tail,l=null,o=null;null!=s;){var c=i(s,a,r);null==l&&(l=c),n.lineTo(c.x,c.y),o=c,s=s.next}null!=l&&null!=o&&(n.lineTo(0,o.y),n.lineTo(0,r+10),n.lineTo(l.x,r+10))}n.closePath(),n.lineWidth=1.5*window.devicePixelRatio,n.lineCap="round",n.strokeStyle="#1976d2",n.fillStyle="#90caf9",n.stroke(),n.fill()}}}},{key:"onMicClick",value:function(){var e=this;this.setState({type:"mic"}),(window.navigator.mediaDevices?window.navigator.mediaDevices.getUserMedia:null)||window.navigator.getUserMedia?window.navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(t){e.stream=t;var n=window.AudioContext||window.webkitAudioContext||!1;e.audioSupported?(e.chunks=[],e.recorder=new MediaRecorder(e.stream),e.recorder.ondataavailable=function(e){this.chunks.push(e.data)}.bind(e),e.recorder.start(),e.recordingStart=Date.now(),n?(e.context=new n,e.analyser=e.context.createAnalyser(),e.source=e.context.createMediaStreamSource(e.stream),e.processor=e.context.createScriptProcessor(1024,1,1),e.volumes=new Y,e.volumeMax=0,e.source.connect(e.analyser),e.analyser.connect(e.processor),e.processor.connect(e.context.destination),e.setState({statusClass:"info",status:e.durationString(Date.now()-e.recordingStart)}),e.processor.onaudioprocess=function(t){if(null!==e.stream&&"mic"===e.state.type&&null!==e.volumes)if(Date.now()-e.recordingStart>25e3)e.stopStream(!0);else{e.analyser.fftSize=2048;var n=e.analyser.frequencyBinCount,a=new Uint8Array(n);e.analyser.getByteFrequencyData(a);for(var r=0,i=0;i<n;++i)r+=a[i];var s=r/n;s>e.volumeMax&&(e.volumeMax=s),e.volumes.push({timestamp:Date.now(),volume:s}),e.statusRef.current.innerHTML=e.durationString(Date.now()-e.recordingStart)}}):(e.volumes=null,setTimeout((function(){Date.now()-e.recordingStart>=25e3&&e.stopStream(!0)}),25e3)),e.startCanvasRendering()):e.micError("Your browser doesn't support audio recording")})).catch((function(t){e.micError(t)})):this.micError("getUserMedia() is not accessible")}},{key:"micError",value:function(e){this.setState({statusClass:"error",status:"Failed to access microphone: "+e}),this.recordingStart=null,this.renderCanvas(!1),this.stream=null}},{key:"startCanvasRendering",value:function(){this.canvasRendering=!0,this.renderCanvas(!0)}},{key:"stopCanvasRendering",value:function(){this.canvasRendering||this.renderCanvas(!1),this.canvasRendering=!1}},{key:"stopStream",value:function(e){var t=this;null!==this.stream&&(e&&(this.recorder.onstop=function(){var e=new Blob(t.chunks,{type:t.recorder.mimeType});t.callback({type:"audio",value:e})}),this.recorder.stop(),this.stopCanvasRendering(),this.stream.getTracks().forEach((function(e){e.stop()})),this.stream=null)}},{key:"durationString",value:function(e){var t=Math.floor(e/1e3),n=Math.floor(t/60);return t%=60,this.addZeros(n)+":"+this.addZeros(t)}},{key:"addZeros",value:function(e,t){return"undefined"===typeof t&&(t=2),"string"!==typeof e&&(e+=""),e.length>=t?e:"0".repeat(t-e.length)+e}},{key:"onCloseClick",value:function(){this.setState({type:"text"}),this.stopStream(!1),this.volumes=null,this.volumeMax=0}},{key:"onInputChange",value:function(){this.updClassName()}},{key:"send",value:function(){if("text"===this.state.type){var e=this.inputRef.current.value.trim();e.length>0&&this.callback({type:"text",value:e})}else null!==this.stream&&this.stopStream(!0)}},{key:"catchEnter",value:function(e){13==e.keyCode&&this.inputDone()&&this.send()}},{key:"inputDone",value:function(){var e,t=this.inputRef.current;return e=null!=t?t.value:"","text"==this.state.type&&e.length>0||"mic"==this.state.type&&this.audioSupported&&"error"!=this.state.statusClass}},{key:"updClassName",value:function(){var e=s.a.findDOMNode(this),t=e.children[e.children.length-1],n=this.inputRef.current.value.trim();t.className=F({TextOrRecordInput:!0,cansend:n.length>0,mic:"mic"===this.state.type,text:"text"===this.state.type})}},{key:"warnText",value:function(){return window.navigator.getUserMedia||window.navigator.mediaDevices&&window.navigator.mediaDevices.getUserMedia||"http:"!==window.location.protocol?"Your browser doesn't support microphone recording.":"Can't access microphone through http:// protocol (use https)"}},{key:"render",value:function(){return r.a.createElement("div",{className:"TextOrRecordInputWrapper"},this.audioSupported?null:r.a.createElement("div",{className:"warning"},r.a.createElement(G,null),this.warnText()),r.a.createElement("div",{className:F({TextOrRecordInput:!0,cansend:this.inputDone(),mic:"mic"===this.state.type,text:"text"===this.state.type}),ref:this.inputDivRef},r.a.createElement("div",{className:"input-wrapper"},r.a.createElement("input",{type:"text",placeholder:"Write lyrics here or press mic...",ref:this.inputRef,onChange:this.onInputChange.bind(this),onKeyPress:this.onInputChange.bind(this),onKeyUp:this.onInputChange.bind(this)})),r.a.createElement("div",{className:"status "+this.state.statusClass,ref:this.statusRef},this.state.status),r.a.createElement("canvas",{ref:this.canvasRef}),r.a.createElement(g,{className:"mic borderless round"+(this.audioSupported?"":" hidden"),onClick:this.onMicClick.bind(this)},r.a.createElement(M,null)),r.a.createElement(g,{className:"close borderless round",onClick:this.onCloseClick.bind(this)},r.a.createElement(_,null)),r.a.createElement(g,{className:"send borderless round",onClick:this.send.bind(this)},r.a.createElement(H,null))))}}]),t}(r.a.Component),Z={},V=[function(e){return JSON.parse(localStorage.getItem(e))},function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?JSON.parse(decodeURIComponent(t[1])):null},function(e){return Z[e]}],$=[function(e,t){return localStorage.setItem(e,JSON.stringify(t))},function(e,t){return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(JSON.stringify(t))},function(e,t){return Z[e]=t}],Q={get:function(e,t){for(var n=null,a=0;a<V.length&&(null==(n=V[a](e))&&"undefined"===typeof n);++a)n=null;return null!=n&&"undefined"!==typeof n||"undefined"===typeof t?n:(Q.set(e,t),t)},set:function(e,t){for(var n=0;n<$.length;++n)$[n](e,t)}};window.Storage=Q;var ee=Q,te=n(18);function ne(e){return Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&")}function ae(e,t){for(var n,a={},r=0;r<e.length;++r)"undefined"===typeof t[n=e[r]]?a[n]=null:a[n]=t[n];return a}var re=ee.get("cache",{});function ie(){for(var e in re)Date.now()-re[e].t>36e5&&delete re[e]}function se(e,t,n,a,r){3===arguments.length&&(a=n,n=void 0);var i=Object(te.a)(e+" "+t).toString(16);!re[i]||"undefined"===typeof re[i].r||null===re[i].r||n?le(e,t,n,(function(e,t){!n&&e&&(re[i]={t:Date.now(),r:t},ie(),ee.set("cache",re)),a.apply(this,Array.prototype.slice.apply(arguments))})):a(!0,re[i].r)}function le(e,t,n,a,r){3===arguments.length&&(a=n,n=void 0);var i=new XMLHttpRequest;i.open(e,t,!0),i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status){var e=i.responseText;try{e=JSON.parse(e)}catch(t){}a(!0,e)}else console.warn("Failed to send HTTP request: bad status code ("+i.status+")"),a(!1,"Bad status code: "+i.status)},r&&i.setRequestHeader("X-Requested-With","XMLHttpRequest"),"function"!==typeof n?i.send():n(i)}var oe,ce=function(){function e(t,n){Object(l.a)(this,e),this.type=t,this.options=n,this.session_id=ee.get("session",function(e){"number"!==typeof e&&(e=16);var t="1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM";return Array.from({length:e},(function(){return t[Math.round(Math.random()*(t.length-1))]})).join("")}(16))}return Object(o.a)(e,[{key:"endpoint",value:function(t){var n=e.endpoint[this.type];return"string"===typeof n?n:"object"===typeof n&&"undefined"===typeof t?n.audd:n[t]}},{key:"query",value:function(e,t){var n={};return"text"===t.type&&(n.q=t.value),"direct"===e?(n.return="timecode,lyrics,apple_music,deezer,spotify",n.api_token=this.options.audd_token):n.session=this.session_id,n}},{key:"simulateAnswer",value:function(e){var t=ee.get("score",{computer:0,human:0});return t[e?"computer":"human"]++,ee.set("score",t),t}},{key:"simulateScore",value:function(){return ee.get("score",{computer:0,human:0})}},{key:"simulateAPIServerResponse",value:function(e){var t=this;return new Promise((function(n,a){var r=function(e){n({result:e,score:t.simulateScore()})};if(e&&"error"!==e.status&&null!==e.result){var i=e.result.list?e.result.list[0]:e.result[0];if("undefined"===typeof i||null===i)return void r(null);"string"===typeof i.media&&(i.media=JSON.parse(i.media)),i.media&&(i.media=i.media.map(ae.bind(t,["provider","url"])));var s=[t.geniusSearch(i),t.deezerSearch(i)];Promise.all(s).then((function(){r(ae(["title","media","artist","lyrics","cover"],i))}))}else r(null)}))}},{key:"putMediaToTrack",value:function(e,t){Array.isArray(e.media)||(e.media=[]),e.media.map((function(e){return e.provider})).indexOf(t.provider)<0&&e.media.push(t)}},{key:"putGeniusData",value:function(e,t){if(e.path&&this.putMediaToTrack(t,{provider:"genius",url:"https://genius.com"+e.path}),e.media)for(var n=0;n<e.media.length;++n)this.putMediaToTrack(t,e.media[n]);e.song_art_image_url&&(t.cover=e.song_art_image_url),!t.song_id&&e.id&&(t.song_id=e.id)}},{key:"probablyEqual",value:function(e,t){var n=Math.min(e.length,t.length);return e.toLowerCase().trim().substring(0,n)===t.toLowerCase().trim().substring(0,n)}},{key:"geniusSearch",value:function(e){var t=this;return new Promise((function(n,a){var r=t.endpoint("genius");e.song_id?r+="songs/"+e.song_id+"?access_token="+t.options.genius_token:r+="search?"+ne({q:e.artist+" "+e.title,access_token:t.options.genius_token}),le("GET",r,(function(r,i){if(r&&i.response&&i.response.hits){for(var s=null,l=0;l<i.response.hits.length;++l){var o=i.response.hits[l];if(o.result&&o.result.title&&o.result.primary_artist.name&&t.probablyEqual(o.result.title,e.title)&&t.probablyEqual(o.result.primary_artist.name,e.artist)){s=o.result;break}}if(null!==s&&(t.putGeniusData(s,e),e.song_id))return void t.geniusSearch(e).then(n).catch(a)}else r&&i.response&&i.response.song&&t.putGeniusData(i.response.song,e);n()}))}))}},{key:"deezerSearch",value:function(e){var t=this;return new Promise((function(n,a){le("GET","https://cors-anywhere.herokuapp.com/"+t.endpoint("deezer")+"search?"+ne({q:'track:"'+e.title+'" artist:"'+e.artist+'"',strict:"on"}),(function(e){return e.send()}),(function(a,r){a&&r.data&&r.data.length>0&&((r=r.data[0]).link&&t.putMediaToTrack(e,{provider:"deezer",url:r.link}),r.album&&r.album.cover_big?e.cover=r.album.cover_big:r.artist&&r.artist.picture_big&&(e.cover=r.artist.picture_big)),n()}),!0)}))}},{key:"sendAnswer",value:function(t){var n=this;return new Promise((function(a,r){"backend"===n.type?le("POST",n.endpoint()+e.path[n.type][t]+"?"+ne({session:n.session_id}),(function(e,t){(e?a:r)(t)})):a(n.simulateAnswer(t))}))}},{key:"send",value:function(t){var n=this;return console.log("API.send(",t,")"),new Promise((function(a,r){var i=n.endpoint()+e.path[n.type][t.type]+"?"+ne(n.query(n.type,t));(new window.XMLHttpRequest).open("POST",i,!0);var s=function(e,t){e?(console.log("<= ",t),"direct"===n.type?n.simulateAPIServerResponse(t).then(a).catch(r):a(t)):r(t)},l="direct"===n.type?se:le;"text"===t.type&&"direct"===n.type?l("POST",i,s):l("POST",i,(function(e){if("audio"===t.type){var n=new window.FormData;console.log(t),n.append("file",t.value),window.data=n,e.send(n)}else"text"===t.type&&e.send()}),s)}))}}]),e}();ce.endpoint={direct:{audd:"https://api.audd.io/",genius:"https://api.genius.com/",deezer:"https://api.deezer.com/"},backend:"https://musical-akinator.herokuapp.com/"},ce.path={direct:{audio:"recognizeWithOffset/",text:"findLyrics/"},backend:{audio:"humming",text:"lyrics",true:"right",false:"wrong"}},oe=ee.get("backend")?new ce("backend"):new ce("backend",{audd_token:"blah",genius_token:"blah"}),window.api=oe;var ue=oe,de=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return this.state.redirect?(Storage.set("guess-state",this.state.redirect),r.a.createElement(p.a,{to:{pathname:"/guess",state:this.state.redirect}})):r.a.createElement("div",null,r.a.createElement("p",null,"Akinator tries to recognize and guess what song you are trying to find. You are welcome to type lyrics or hum song's rythm in microphone."),r.a.createElement(X,{onSelect:function(t){e.setState({redirect:{input:t}})}}),r.a.createElement("br",null),r.a.createElement("p",null,r.a.createElement("b",null,"How does this work?")),r.a.createElement("p",null,"We use these APIs:"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("a",{href:"https://audd.io/"},"audd.io")," \u2014 for recognition and track's search"),r.a.createElement("li",null,r.a.createElement("a",{href:"https://docs.genius.com/"},"Genius API")," \u2014 for obtaining more info about songs"),r.a.createElement("li",null,r.a.createElement("a",{href:"https://developers.deezer.com/api"},"Deezer API")," \u2014 also for obtaining song's info (not so accurate)")),r.a.createElement("p",null,"Website also tries to add widgets from following social medias: ",r.a.createElement("b",null,"YouTube"),", ",r.a.createElement("b",null,"Deezer"),", ",r.a.createElement("b",null,"Spotify"),", ",r.a.createElement("b",null,"Soundcloud"),"."),r.a.createElement("p",null,"Now this website is based on","direct"===ue.type?r.a.createElement("span",null," ",r.a.createElement("b",null,"its own"),". (sends requests directly to API and simulates backend logic)"):r.a.createElement("span",null," ",r.a.createElement("b",null,"server"),". (sends requests to backend server)")),r.a.createElement("p",null,"Made by:"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("b",null,r.a.createElement("a",{className:"dev",href:"https://dkaraush.me"},"Dmitriy Karaush"))," \u2014 ",r.a.createElement("a",{href:"https://github.com/dkaraush/musical-akinator"},"frontend")," made with React."),r.a.createElement("li",null,r.a.createElement("b",null,r.a.createElement("a",{className:"dev",href:"https://t.me/thejunglegiant"},"Oleksii Morozov"))," \u2014 ",r.a.createElement("a",{href:"https://github.com/thejunglegiant/backend-musical-akinator"},"backend"),".")))}}]),t}(r.a.Component);n(43);function he(e){var t=[];for(var n in e)e[n]&&t.push(n);return t.join(" ")}var pe=function(e){return r.a.createElement("div",{className:he({loading:!0,inline:e.inline})})};function me(){return(me=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function fe(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var ve=r.a.createElement("path",{d:"M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"}),ge=function(e){var t=e.svgRef,n=e.title,a=fe(e,["svgRef","title"]);return r.a.createElement("svg",me({width:24,height:24,viewBox:"0 0 24 24",ref:t},a),n?r.a.createElement("title",null,n):null,ve)},ye=r.a.forwardRef((function(e,t){return r.a.createElement(ge,me({svgRef:t},e))}));n.p,n(44);function be(e){return(e=(e=e.replace(/_/g," ")).trim()).slice(0,1).toUpperCase()+e.slice(1)}var we=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).social=e.social,n.link=e.link||e.href,n.img=!1,["apple_music","spotify","genius","soundcloud","youtube","deezer"].indexOf(e.social)>=0&&(n.img=!0),n.state={size:"big"===e.size?window.innerWidth<700?"small":"big":e.size||"small"},n.onResize=n.resize.bind(Object(v.a)(n)),n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){"big"===this.props.size&&window.addEventListener("resize",this.onResize)}},{key:"componentWillMount",value:function(){"big"===this.props.size&&window.removeEventListener("resize",this.onResize)}},{key:"resize",value:function(){var e=window.innerWidth<700?"small":"big";e!=this.state.size&&this.setState({size:e})}},{key:"render",value:function(){return r.a.createElement("a",{className:"media-link "+this.state.size,href:this.link,title:be(this.social),target:"_blank"},this.img?r.a.createElement("div",{style:{backgroundImage:"url(/social/"+this.state.size+"/"+this.social+".svg)"}}):be(this.social))}}]),t}(r.a.Component),Ee=(n(45),{youtube:function(e){var t=e.url.match(/^(?:https?\:)?(?:\/\/)?(?:www\.)?youtu\.?be(?:\.com)?\/(?:watch\?v=)?([A-Za-z0-9_-]{11})/);return null===t||t.length<1?null:(t=t[1],r.a.createElement("iframe",{key:"youtube",type:"text/html",className:"youtube-widget",src:"https://www.youtube.com/embed/"+t+"?enablejsapi=1",frameBorder:"0"}))},deezer:function(e){var t=e.url.match(/^(?:https?\:)?(?:\/\/)?(?:www\.)?deezer\.com\/track\/(\d+)(?:\?.+)?(?:\#.+)?$/);return console.log(t),null===t||t.length<1?null:(t=t[1],r.a.createElement("iframe",{key:"deezer",className:"deezer-widget",scrolling:"no",frameBorder:"0",allowtransparency:"true",src:"https://www.deezer.com/plugins/player?format=classic&autoplay=false&playlist=true&width=700&height=350&color=E08000&layout=&size=medium&type=tracks&app_id=1&id="+t,width:"100%",height:"95"}))},soundcloud:function(e){return r.a.createElement("iframe",{key:"soundcloud",className:"soundcloud-widget",width:"100%",height:"166",scrolling:"no",frameBorder:"no",allow:"autoplay",src:"https://w.soundcloud.com/player/?url="+encodeURIComponent(e.url)})},spotify:function(e){return r.a.createElement("iframe",{key:"spotify",className:"spotify-widget",width:"100%",height:"300",scrolling:"no",frameBorder:"0",allowtransparency:"true",src:"https://open.spotify.com/embed?uri="+encodeURIComponent(e.url)})}}),ke=function(e){var t=e.track||e.data,n=e.multiple||!1;if(null===t.media||0===t.media.length)return null;var a=[];for(var r in Ee)for(var i=0;i<t.media.length;++i)if(r===t.media[i].provider){var s=Ee[r](t.media[i]);if(null!==s){if(!n)return s;a.push(s)}break}return a};n(46);function Oe(e,t){if(null==t)return e;var n,a=e.toLowerCase(),i=(t=t.toLowerCase().trim()).split(/ /g),s=[],l=0,o=-1;do{n=-1,o=-1;for(var c=0;c<i.length;++c){var u=a.indexOf(i[c],l);-1!=u&&((n>u||-1==n)&&(n=u,o=c))}if(-1==o||-1==n)break;s.push([n,n+i[o].length]),l=n+i[o].length+1}while(-1!=n);if(0==s.length)return e;for(var d=0;d<s.length-1;++d){var h=s[d],p=s[d+1];h[1]==p[0]&&(s[d][1]=p[1],s.splice(d+1,1),d--)}var m=[];l=0;for(var f=0,v=0;f<s.length;++f){var g=s[f];g[0]>l&&(m.push(e.substring(l,g[0])),l=g[0]),m.push(r.a.createElement("span",{className:"highlight",key:++v},e.substring(g[0],g[1]))),l=g[1]}return l<e.length&&m.push(e.substring(l)),m}var Se=function(e){var t=e.data||e.track,n=e.q||null,a=(t.media||[]).map((function(e){return r.a.createElement(we,{href:e.url||e.uri,social:e.provider,key:e.provider,size:"big"})}));return r.a.createElement("div",{className:"track-wrapper"},r.a.createElement("div",{className:"track-big"},r.a.createElement("div",{className:"cover-wrapper"},r.a.createElement("div",{className:"cover"},r.a.createElement("div",{className:"bg"},r.a.createElement(ye,null)),t.cover?r.a.createElement("div",{className:"cover-img",style:{backgroundImage:"url("+t.cover+")"}}):null)),r.a.createElement("div",{className:"info"},r.a.createElement("div",{className:"meta"},r.a.createElement("h1",null,Oe(t.title,n)),r.a.createElement("h2",null,Oe(t.artist,n))),r.a.createElement("div",{className:"media"},r.a.createElement("span",null,a)))),r.a.createElement(ke,{track:t}),null!==t.lyrics&&"undefined"!==typeof t.lyrics&&t.lyrics.length>0?r.a.createElement("div",{className:"lyrics"},r.a.createElement("span",{className:"header"},"Lyrics"),r.a.createElement("span",null,Oe(t.lyrics,n))):null)},je=(n(47),function(e){var t=e.track||e.data||{},n=(t.media||[]).sort().map((function(e){return r.a.createElement(we,{href:e.url||e.uri,social:e.provider,key:e.provider,size:"small"})}));return r.a.createElement("div",{className:"track-small"},r.a.createElement("div",{className:"cover"},r.a.createElement("div",{className:"blank"},r.a.createElement(ye,null)),r.a.createElement("div",{className:"img",style:{backgroundImage:"url("+t.cover+")"}})),r.a.createElement("div",{className:"info"},r.a.createElement("span",null,r.a.createElement("h1",null,t.title),r.a.createElement("h2",null,t.artist))),r.a.createElement("div",{className:"media"},r.a.createElement("span",null,n)))});n(48);var Re=function(e){for(var t,n=e.score||{},a=[],i=Object.keys(n),s=0,l=0;s<i.length;++s)a.push(r.a.createElement("span",{key:++l,className:"player"},r.a.createElement("span",{className:"name"},(t=(t=(t=i[s]).replace(/_/g," ")).trim()).slice(0,1).toUpperCase()+t.slice(1)),r.a.createElement("span",{className:"value"},n[i[s]]))),i.length-1!==s&&a.push(r.a.createElement("span",{key:++l,className:"separator"},":"));return r.a.createElement("div",{className:"score"},r.a.createElement("div",null,a))},xe=new(function(){function e(){Object(l.a)(this,e),this.data=ee.get("last-data",{}),this.list=ee.get("last-list",[]),this.clean()}return Object(o.a)(e,[{key:"calcHash",value:function(e){return Object(te.a)(JSON.stringify(e))}},{key:"push",value:function(e){e.lyrics&&delete(e=Object.assign({},e)).lyrics;var t,n=this.calcHash(e).toString(16);if((t=this.list.indexOf(n))>=0)return this.list.splice(t,1),void this.list.push(n);this.data[n]=e,this.list.push(n),this.clean(),this.save()}},{key:"clean",value:function(){for(var e in this.list.length>5&&this.list.splice(0,this.list.length-5),this.data)this.list.indexOf(e)<0&&delete this.data[e];for(var t=0;t<this.list.length;++t)"undefined"===typeof this.data[this.list[t]]&&(this.list.splice(t,1),t--)}},{key:"save",value:function(){ee.set("last-data",this.data),ee.set("last-list",this.list)}},{key:"length",value:function(){return Math.max(this.list.length,5)}},{key:"getData",value:function(){var e=this;return this.list.slice().reverse().map((function(t){return e.data[t]}))}}]),e}()),Ce=(n(49),function(e){function t(e){var n;Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).pushState=n._setState.bind(Object(v.a)(n),!1),n.state={};var a=Storage.get("guess-state");n.pushState(n.props.location.state),a&&n.pushState(a);var r=null;return n.state.input&&"text"===n.state.input.type&&(r=n.state.input),n.props.location.state&&n.props.location.state.input&&(r=n.props.location.state.input),!n.state.loaded&&r&&n.init(!1,r),n.lastTracks=xe.getData(),n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.pushState=this._setState.bind(this,!0)}},{key:"_setState",value:function(e,t){e?this.setState(t||{}):this.state=Object.assign(this.state||{},t||{});var n=Object.assign({},Object.assign(this.state||{},t||{}));n&&delete n.input,Storage.set("guess-state",n)}},{key:"init",value:function(e,t){var n=this;this.props.location.state=t;var a={};"text"===t.type&&(a.q=t.value),a.loading=!0,this.pushState(a),ue.send(t).then((function(t){n.lastTracks=xe.getData(),null==t.result?(n.vote(!1,!0),n.pushState({voted:!0})):e&&n.pushState({voted:!1}),n.pushState({loading:!1,loaded:!0,track:t.result,score:t.score},!0)})).catch((function(e){n.pushState({loading:!1,error:e})}))}},{key:"vote",value:function(e,t){var n=this;!t&&this.state.voted||(e&&xe.push(this.state.track),this.pushState({voted:!0}),ue.sendAnswer(e).then((function(e){n.pushState({score:e})})))}},{key:"render",value:function(){return null===this.props.location.state||"undefined"===typeof this.props.location.state?r.a.createElement(p.a,{to:"/"}):this.state.loading?r.a.createElement("div",null,r.a.createElement("p",{className:"center"},"Searching your track..."),r.a.createElement(pe,null)):(console.log(xe),r.a.createElement("div",null,r.a.createElement("div",{className:"voting"+(this.state.voted||!this.state.track?" voted":"")},r.a.createElement("div",null,r.a.createElement(Re,{score:this.state.score}),r.a.createElement("p",null,"What about next song?"),r.a.createElement(X,{onSelect:this.init.bind(this,!0)})),r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("p",null,"Is it ",this.state.track?r.a.createElement("span",null,r.a.createElement("b",null,this.state.track.artist," \u2014 ",this.state.track.title)):null,"?"),r.a.createElement("div",{className:"buttons"},r.a.createElement(g,{invert:!0,onClick:this.vote.bind(this,!0)},"Right!"),r.a.createElement(g,{onClick:this.vote.bind(this,!1)},"No...")))),this.state.track?null:r.a.createElement("div",null,r.a.createElement("p",{className:"center"},"Unfortunately, we didn't find any track. You won this round.")),r.a.createElement("div",{className:"last"+(this.state.voted&&this.state.loaded&&this.lastTracks.length>0?" visible":"")},r.a.createElement("p",null,r.a.createElement("b",null,"Last correctly guessed tracks:")),this.state.voted&&this.state.loaded?this.lastTracks.map((function(e,t){return r.a.createElement(je,{track:e,key:t})})):null),this.state.track?r.a.createElement(Se,{track:this.state.track,q:this.state.q}):null))}}]),t}(r.a.Component)),Me=function(){return r.a.createElement("div",null,r.a.createElement("p",null,"404!"))};n(50);var Ne=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.unlisten=this.props.history.listen((function(e,t){document.querySelector("#header").className="/"==window.location.pathname?"index":""}))}},{key:"componentWillUnmount",value:function(){this.unlisten()}},{key:"render",value:function(){return r.a.createElement("div",{id:"content"},r.a.createElement(m.a,{className:"transition-group"},r.a.createElement(f.a,{key:this.props.location.key,timeout:{enter:150,exit:150},classNames:"fade"},r.a.createElement("section",{className:"route-section"},r.a.createElement(p.d,{location:this.props.location},r.a.createElement(p.b,{path:"/",exact:!0,component:de}),r.a.createElement(p.b,{path:"/guess/",component:Ce}),r.a.createElement(p.b,{component:Me}))))))}}]),t}(r.a.Component),ze=Object(p.g)(Ne);s.a.render(r.a.createElement((function(){return r.a.createElement("div",{id:"container"},r.a.createElement(h.a,null,r.a.createElement(h.b,{id:"header",className:"/"==window.location.pathname?"index":"",to:"/"},r.a.createElement(g,{round:!0,className:"borderless",to:"/"},r.a.createElement(O,null)),r.a.createElement("h1",null,"Musical Akinator")),r.a.createElement(ze,null)))}),null),document.getElementById("root"))}},[[28,1,2]]]);
//# sourceMappingURL=main.eb102ab2.chunk.js.map